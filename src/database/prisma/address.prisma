// This is your Prisma schema file for FleetStack_Address (Address Database)
// Learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../../../node_modules/@prisma/address"
}

datasource db {
  provider = "postgresql"
  url      = env("ADDRESS_DATABASE_URL")
}

// Address Database Models (Addresses, Locations, Geospatial Data)

model Address {
  id           String   @id @default(cuid())
  street       String
  streetNumber String?
  city         String
  state        String
  postalCode   String
  country      String   @default("US")
  latitude     Float?
  longitude    Float?
  isActive     Boolean  @default(true)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  // Relations
  locations Location[]

  @@map("addresses")
}

model Location {
  id          String      @id @default(cuid())
  name        String
  addressId   String
  type        LocationType
  description String?
  metadata    Json?
  isActive    Boolean     @default(true)
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  // Relations
  address Address @relation(fields: [addressId], references: [id], onDelete: Cascade)

  @@map("locations")
}

model GeoFence {
  id          String   @id @default(cuid())
  name        String
  description String?
  coordinates Json     // Store polygon/circle coordinates
  radius      Float?   // For circular geofences
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("geo_fences")
}

model Route {
  id          String   @id @default(cuid())
  name        String
  description String?
  startPoint  Json     // Store start coordinates
  endPoint    Json     // Store end coordinates
  waypoints   Json?    // Store intermediate waypoints
  distance    Float?   // Distance in kilometers
  duration    Int?     // Duration in minutes
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("routes")
}

// Enums
enum LocationType {
  WAREHOUSE
  DEPOT
  CUSTOMER
  SERVICE_CENTER
  FUEL_STATION
  PARKING
  MAINTENANCE
}